<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/fomantic-ui@2.7.2/dist/semantic.min.css">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
  <link rel="stylesheet" href="css/style.css">

  <title>Teams</title>
  <!-- Some css for this new page -->
  <style>

    h1 {
    text-align: center;
  }

  p{
    text-align: center;
    font-weight: bold;
    font-size: 120%;
  }

    .ui.container {
    margin-top:5%;
    padding-left: 100px;
    padding-right: 100px;
    font-size: 120%;
    }

    .description {
	  font-style:italic;
	  font-weight:bold;
    }

    .date{
      color: #DC124E;
    }

     form {
       padding:1em;
     }

     #btncall {
       margin-top:1em;
     }

     #btn{
       text-align: center;
     }

     #cards{
       padding-bottom: 30px;
     }
    </style>
</head>

<body>
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <a class="navbar-brand" href="index.html">
      <img src="images/brand.jpg" class="image-fluid" width="50" height="50" alt="" />
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
      <div class="navbar-nav ml-auto">
        <a class="nav-item nav-link" href="index.html">Home <span class="sr-only">(current)</span></a>
        <a class="nav-item nav-link" href="about.html">About</a>
        <a class="nav-item nav-link" href="teams.html">Teams</a>
        <a class="nav-item nav-link" href="games.html">Games</a>
        <a class="nav-item nav-link" href="form.html">Sign Up</a>
      </div>
    </div>
  </nav>

  <div class="card-body text-center">
    <img src="images/brand.jpg" class="image-fluid" width="10%" height="10%" alt="" />
    <hr />
    <h5 class="card-title">Team Cards</h5>
    <p class="card-text">
      Here teams can add some basic info about themselves.<br />
      This is optional and seperate to team registration.<br /> A default image will be used for new teams.
    </p>
  </div>
  <hr />

  <div class="ui container">
    <script id="team-cards" type="text/x-handlebars-template">

      <!-- Using the each Helper to create a card for every team in the teams array-->
  {{#each teams}}
    <div class="ui card">

      <div class="image">
    <img src = {{image}} />
      </div>
      <div class="content">
        <!-- Calling the custom helper upper to change name to uppercase-->
        <a class="header"> {{upper name}} </a>
        <div class="meta">
          <span class="date"> Founded in {{founded}}</span>
        </div>
        <div class="description">
          Location: {{origin}}
        </div>
      </div>
      <div class="extra content">
        <a>
          <i class="user icon"></i>
          Members: {{members}}
        </a>
      </div>
    </div>
    {{/each}}
    </script>

    <!-- div where the content will be added -->
    <div id="cards" class="ui link cards"></div>
    <hr />
    <!-- button to access form -->
    <div id="btn">
      <button class="ui primary button" id="btncall">Add Your Team</button>
    </div>
    <hr />
  </div>


  <!-- Form for taking the users new team information -->
  <div class="ui modal teamform">
    <i class="close icon"></i>
    <div class="header">
      <h1>Add Your Team Details</h1>
    </div>
    <form name='teamlist' id="teamlist" class="ui form">
      <div class="inline field">
        <label for="name" class="two wide field">Name (Capitalised)</label>
        <input type="text" class="eight wide field" name="name" id="name" autofocus required pattern="[A-Z][a-z]+( [A-Z][a-z]+)?" title="Please enter your Team name with first letter Capitalised">
      </div>

      <div class="inline field">
        <label for="year" class="two wide field">Year Founded<br />(4 Digits)</label>
        <input type="text" class="eight wide field" name="founded" id="founded" autofocus required pattern="\d{4}" title="Please enter the year your team was founded.">
      </div>

      <div class="inline field">
        <label for="location" class="two wide field">Location (Capitalised)</label>
        <input type="text" class="eight wide field" name="origin" id="origin" autofocus required pattern="[A-Z][a-z]+( [A-Z][a-z]+)?" title="Please enter your teams location with first letter Capitalised">
      </div>

      <div class="inline field">
        <label for="members" class="two wide field">No. of Members (1 digit)</label>
        <input type="text" class="eight wide field" name="members" id="members" autofocus required pattern="\d" title="Please enter the number of members on your team.">
      </div>

      <input type="submit" id="thesubmit" class="ui primary button" value="Add Your Team">
    </form>
  </div>



  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/semantic.min.js"></script>
  <script src='https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.1.1/handlebars.min.js'></script>
  <script>
    $(document).ready(function() {
      //Team array holding current teams and will be taking the new teams added
      const teams = {
        "teams": [{
            "name": "faze clan",
            "image": "images/faze.jpg",
            "founded": 2010,
            "origin": "US",
            "members": 8
          },
          {
            "name": "team solo mid",
            "image": "images/tsm.jpg",
            "founded": 2011,
            "origin": "United States",
            "members": 6
          },
          {
            "name": "team liquid",
            "image": "images/liquid.jpg",
            "founded": 2000,
            "origin": "Netherlands",
            "members": 7
          },
          {
            "name": "ghost gaming",
            "image": "images/ghost.jpg",
            "founded": 2017,
            "origin": "North America",
            "members": 4
          },
          {
            "name": "team secret",
            "image": "images/secret.jpg",
            "founded": 2014,
            "origin": "Europe",
            "members": 4
          }
        ]
      }
      //Custom Helper to change Team names to UpperCase
      Handlebars.registerHelper('upper', function(str) {
        return str.toUpperCase();
      });

      //compiling template and appending to #cards div.
      let template = Handlebars.compile($('#team-cards').html());

      let thecontent = template(teams);

      $("#cards").append(thecontent);

      //on button click show the form
      $("#btncall").on('click', function() {
        $(".teamform").modal('show');
      });

      //Handles the processing of the information entered. Adds to the cards list.
      $('#teamlist').submit(function(evt) {
        evt.preventDefault();

        newteam = {
          name: $('#name').val(),
          image: "images/newteam.jpg",
          founded: $('#founded').val(),
          origin: $("#origin").val(),
          members: $("#members").val()
        }
        teams.teams.push(newteam);
        let theCompiledHtml = template(teams);
        $("#cards").html(theCompiledHtml);
        $('.teamform').modal('hide');
        $('input[type="text"]').each(function() {
          $(this).val("");
        });
        return false;
      });


    });
  </script>

  <footer class="container-fluid bg-dark">
    <p>
      &copy; Kyle Fox 2019
    </p>
  </footer>
</body>

</html>
